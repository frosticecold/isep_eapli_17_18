title SD Register Meal Delivery

RegisterMealDeliveryUI->RegisterMealDeliveryController : create()
RegisterMealDeliveryUI -> RegisterMealDeliveryController : registerNewMealDelivery()
RegisterMealDeliveryController -> POS : createNewSession()
POS -> PersistenceContext : repositories()
PersistenceContext  -> RepositoryFactory : deliveryMealSessionsRepo = getDeliveryMealSessionsRepository()
RepositoryFactory -> DeliveryMealSessionRepository : session = createNewSessionMeal()
DeliveryMealSessionRepository -> DeliveryMealSession : create()
DeliveryMealSession -> DeliveryRegistry : create()
RegisterMealDeliveryController -> POS : bookings = getBookings()
POS -> PersistenceContext : repositories()
PersistenceContext -> RepositoryFactory : bookingsRepo = getBookingsRepository()
RegisterMealDeliveryController -> POS : booking = getBooking(id, name)
POS -> BookingsRepository : booking = findBooking(id, name)
BookingsRepository -> Booking : checkBookingState()
RegisterMealDeliveryController -> POS : meal = getMeal(booking)
POS -> PersistenceContext  : repositories()
PersistenceContext  -> RepositoryFactory : mealsRepo = getMealsRepository()
RepositoryFactory -> MealsRepository : meal = getMeal(booking)
RegisterMealDeliveryController -> POS : price = calculatePriceWithPenalty(meal)
POS -> POS : price = calculatePriceWithPenalty(meal, penalty)
RegisterMealDeliveryController -> POS : changeBookingState(booking)
POS -> Booking : changeState()
RegisterMealDeliveryUI -> RegisterMealDeliveryUI : showFeedback()